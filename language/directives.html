
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Directives &#8212; OpenQASM Live Specification  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/colors.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Circuit timing" href="delays.html" />
    <link rel="prev" title="Subroutines" href="subroutines.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="directives">
<h1>Directives<a class="headerlink" href="#directives" title="Permalink to this headline">¶</a></h1>
<p>OpenQASM supports a directive mechanism that allows other information to
be included in the program. A directive begins with <code class="docutils literal notranslate"><span class="pre">#pragma</span></code> and
terminates at the end of the line. Directives can provide annotations
that give additional information to compiler passes and the target
system or simulator. Ideally the meaning of the program does not change
if some or all of the directives are ignored, so they can be interpreted
at the discretion of the consuming process.</p>
</section>
<section id="input-output">
<h1>Input/output<a class="headerlink" href="#input-output" title="Permalink to this headline">¶</a></h1>
<p>OpenQASM introduces features targeted to support near-time computation, in
the form of parameterized circuits. These features are modifiers <code class="docutils literal notranslate"><span class="pre">input</span></code>
and <code class="docutils literal notranslate"><span class="pre">output</span></code>, which allow OpenQASM3 circuits to accept input parameters
and return select output parameters.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">input</span></code> modifier can be used to indicate that one or more variable
declarations represent values which will be provided at run-time, upon
invocation. This allows the programmer to use the same compiled circuits
which only differ in the values of certain parameters. For backward compatibility,
OpenQASM3 does not require an <code class="docutils literal notranslate"><span class="pre">input</span></code> declaration to be provided. When
an <code class="docutils literal notranslate"><span class="pre">input</span></code> declaration is provided, the compiler produces an executable
that leaves these free parameters unspecified: a circuit run would take as
input both the executable and some choice of the parameters.</p>
<p>Similarly, the <code class="docutils literal notranslate"><span class="pre">output</span></code> modifier can be used to indicate that one or more variables
are to be provided as an explicit output of the quantum procedure. Note that
OpenQASM 2 did not allow the programmer to specify that only a subset of its
variables should be returned as output, and so it would return all classical
variables (which were all creg variables) as output. For compatibility,
OpenQASM 3 does not require an output declaration to be provided: in this
case it assumes that all of the declared variables are to be returned as
output. If the programmer provides one or more output declarations, then only
those variables described as outputs will be returned as an output of the
quantum process. A variable may not be marked as both input and output.</p>
<p>The input and output modifiers allow the programmer to more easily write
variational quantum algorithms: a quantum algorithm with some free parameters,
which may be run many times with different parameter values which are determined
by a classical optimiser at near-time. Rather than write a circuit which
generates a new sequence of operations for each run, OpenQASM 3 allows such
circuits to be expressed as a single program with input parameters. This
allows the programmer to communicate many different circuits with a single
file, which only has to be compiled once, amortizing the cost of compilation
across many runs. For an example, we may consider a parameterized circuit which
performs a measurement in a basis given by an input parameter:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">input</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">basis</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0 = X basis, 1 = Y basis, 2 = Z basis</span>
<span class="n">output</span><span class="w"> </span><span class="n">bit</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
<span class="n">qubit</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Some complicated circuit...</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">basis</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>
<span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">basis</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">rx</span><span class="p">(</span><span class="n">π</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>
<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">measure</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>For a second example, consider the Variable Quantum Eigensolver (VQE) algorithm <span id="id1">[<a class="reference internal" href="../index.html#id54" title="Alberto Peruzzo, Jarrod McClean, Peter Shadbolt, Man-Hong Yung, Xiao-Qi Zhou, Peter J. Love, Alán Aspuru-Guzik, and Jeremy L. O’Brien. A variational eigenvalue solver on a photonic quantum processor. Nature Communications, Jul 2014. URL: http://dx.doi.org/10.1038/ncomms5213, doi:10.1038/ncomms5213.">PMS+14</a>]</span>.
In this algorithm the same circuit is repeated
many times using different sets of free parameters to minimize an expectation
value. The following is an example, in which there is also more than one input
variable:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">input</span><span class="w"> </span><span class="n">angle</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="w"> </span><span class="n">param1</span><span class="p">;</span><span class="w"></span>
<span class="n">input</span><span class="w"> </span><span class="n">angle</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="w"> </span><span class="n">param2</span><span class="p">;</span><span class="w"></span>
<span class="n">qubit</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Build an ansatz using the above free parameters, eg.</span>
<span class="n">rx</span><span class="p">(</span><span class="n">param1</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>
<span class="n">ry</span><span class="p">(</span><span class="n">param2</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Estimate the expectation value and store in an output variable</span>
</pre></div>
</div>
<p>The following Python pseudocode illustrates the differences between using and
not using parameterized circuits in a quantum program for the case of the VQE:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example without using parametric circuits:</span>

<span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">:</span>
    <span class="c1"># Create an OpenQASM circuit with θ defined</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">subsitute_theta</span><span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;circuit.qasm&quot;</span><span class="p">))</span>

    <span class="c1"># The slow compilation step is run on each iteration of the inner loop</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="n">compile_qasm</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">run_program</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>

<span class="c1"># Example using parametric circuits:</span>

<span class="c1"># parametric_circuit.qasm begins with the line &quot;input angle θ;&quot;</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s2">&quot;parametric_circuit.qasm&quot;</span><span class="p">)</span>

<span class="c1"># The slow compilation step only happens once</span>
<span class="n">binary</span> <span class="o">=</span> <span class="n">compile_qasm</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>

<span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">:</span>
    <span class="c1"># Each iteration of the inner loop is reduced to only running the circuit</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">run_program</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">θ</span><span class="o">=</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">OpenQASM Live Specification</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Language</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="comments.html">Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="comments.html#version-string">Version string</a></li>
<li class="toctree-l2"><a class="reference internal" href="comments.html#included-files">Included files</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">Types and Casting</a></li>
<li class="toctree-l2"><a class="reference internal" href="gates.html">Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="insts.html">Built-in quantum instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="classical.html">Classical instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="subroutines.html">Subroutines</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Directives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-output">Input/output</a></li>
<li class="toctree-l2"><a class="reference internal" href="delays.html">Circuit timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="pulses.html">Pulse-level descriptions of gates and measurement</a></li>
<li class="toctree-l2"><a class="reference internal" href="openpulse.html">OpenPulse Grammar</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../grammar/index.html">OpenQasm 3.0 Grammar</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Language</a><ul>
      <li>Previous: <a href="subroutines.html" title="previous chapter">Subroutines</a></li>
      <li>Next: <a href="delays.html" title="next chapter">Circuit timing</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2020, Andrew W. Cross, Lev S. Bishop, John A. Smolin, Jay M. Gambetta.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/language/directives.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>